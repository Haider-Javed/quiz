// Pakistan History MCQs
const pakistanHistoryQuestions = [
    {
        question: "Who was the founder of Pakistan?",
        options: ["Liaquat Ali", "Muhammad Ali", "Allama Iqbal", "Zulfikar"],
        answer: "Muhammad Ali"
    },
    {
        question: "In which year did Pakistan gain independence?",
        options: ["1945", "1946", "1947", "1948"],
        answer: "1947"
    },
    {
        question: "What was the first capital of Pakistan?",
        options: ["Islamabad", "Karachi", "Lahore", "Rawalpindi"],
        answer: "Karachi"
    },
    {
        question: "Who served as Pakistan's first Governor-General?",
        options: ["Liaquat Ali", "Muhammad Ali", "Iskander", "Ayub Khan"],
        answer: "Muhammad Ali"
    },
    {
        question: "When pakistani politics face military rule?",
        options: ["1958", "1965", "1971", "1977"],
        answer: "1958"
    },
    {
        question: "Who was the first Prime Minister of Pakistan?",
        options: ["Zulfiqar Ali", "Liaquat Ali", "Benazir", "Nawaz"],
        answer: "Liaquat Ali"
    },
    {
        question: "When Pakistan tested nuclear weapon?",
        options: ["1947", "1965", "1971", "1998"],
        answer: "1998"
    },
    {
        question: "When imran khan become prime minister of pakistan?",
        options: ["2018", "2019", "2020", "2021"],
        answer: "2018"
    },
    {
        question: "Which Pakistani leader introduced the 1973 Constitution?",
        options: ["Zulfikar Ali", "Ayub Khan", "Benazir", "Nawaz"],
        answer: "Zulfikar Ali"
    },
    {
        question: "When was the Pakistan Day celebrated for the first time?",
        options: ["1947", "1948", "1956", "1958"],
        answer: "1956"
    }
];

// World History MCQs
const worldHistoryQuestions = [
    {
        question: "Who was the first emperor of Rome?",
        options: ["Julius Caesar", "Augustus", "Nero", "Caligula"],
        answer: "Augustus"
    },
    {
        question: "In which year did World War I begin?",
        options: ["1912", "1914", "1916", "1918"],
        answer: "1914"
    },
    {
        question: "Which revolution started in France in 1789?",
        options: ["Russian Revolution", "French Revolution", "Industrial Revolution", "American Revolution"],
        answer: "French Revolution"
    },
    {
        question: "Who was the leader of the Soviet Union during WWII?",
        options: ["Vladimir Lenin", "Joseph Stalin", "Mikhail Gorbachev", "Nikita Khrushchev"],
        answer: "Joseph Stalin"
    },
    {
        question: "Which empire built the Great Wall of China?",
        options: ["Mongol Empire", "Qin Dynasty", "Han Dynasty", "Ming Dynasty"],
        answer: "Qin Dynasty"
    },
    {
        question: "Who discovered America in 1492?",
        options: ["Ferdinand Magellan", "Columbus", "Vasco da Gama", "Marco Polo"],
        answer: "Columbus"
    },
    {
        question: "When human first land to Moon?",
        options: ["1969", "1970", "1971", "1972"],
        answer: "1969"
    },
    {
        question: "Which civilization built the pyramids in Egypt?",
        options: ["Greek", "Roman", "Egyptian", "Mesopotamian"],
        answer: "Egyptian"
    },
    {
        question: "When did the Berlin Wall fall?",
        options: ["1987", "1988", "1989", "1990"],
        answer: "1989"
    },
    {
        question: "When UNO came in existance?",
        options: ["1945", "1946", "1947", "1948"],
        answer: "1945"
    }
];

// Science MCQs
const scienceQuestions = [
    {
        question: "What is the chemical symbol for water?",
        options: ["H2O", "O2", "CO2", "HO"],
        answer: "H2O"
    },
    {
        question: "Who proposed the theory of relativity?",
        options: ["Isaac Newton", "Albert Einstein", "Galileo Galilei", "Nikola Tesla"],
        answer: "Albert Einstein"
    },
    {
        question: "What is the powerhouse of the cell?",
        options: ["Nucleus", "Mitochondria", "Ribosome", "Golgi apparatus"],
        answer: "Mitochondria"
    },
    {
        question: "Which planet is known as the Red Planet?",
        options: ["Mars", "Venus", "Jupiter", "Saturn"],
        answer: "Mars"
    },
    {
        question: "What is the speed of light in vacuum?",
        options: ["3×10^8 m/s", "3×10^6 m/s", "3×10^5 m/s", "3×10^7 m/s"],
        answer: "3×10^8 m/s"
    },
    {
        question: "Who discovered penicillin?",
        options: ["Alexander Fleming", "Marie Curie", "Louis Pasteur", "Gregor Mendel"],
        answer: "Alexander Fleming"
    },
    {
        question: "What is the basic unit of life?",
        options: ["Atom", "Molecule", "Cell", "Tissue"],
        answer: "Cell"
    },
    {
        question: "Which gas is most abundant in Earth's atmosphere?",
        options: ["Oxygen", "Nitrogen", "Carbon Dioxide", "Hydrogen"],
        answer: "Nitrogen"
    },
    {
        question: "What is the main function of white blood cells?",
        options: ["Transport oxygen", "Fight infection", "Clot blood", "Store energy"],
        answer: "Fight infection"
    },
    {
        question: "Which element has the atomic number 1?",
        options: ["Helium", "Hydrogen", "Oxygen", "Carbon"],
        answer: "Hydrogen"
    }
];

// Computer Science MCQs
const computerScienceQuestions = [
    {
        question: "When C++ was created?",
        options: ["1972", "1970", "1979", "1999"],
        answer: "1979"
    },
    {
        question: "Who is known as the father of computers?",
        options: ["Alan Turing", "Charles Babbage", "Bill Gates", "Steve Jobs"],
        answer: "Charles Babbage"
    },
    {
        question: "Which language is primarily used for web development?",
        options: ["Python", "JavaScript", "C++", "Java"],
        answer: "JavaScript"
    },
    {
        question: "DFS and BFS use to traverse?",
        options: ["Graphs", "queue", "array", "lists"],
        answer: "Graphs"
    },
    {
        question: "Which data structure uses FIFO principle?",
        options: ["Stack", "Queue", "Tree", "Graph"],
        answer: "Queue"
    },
    {
        question: "Where does HTML use?",
        options: ["Webdev", "Game dev", "App dev", "Machine learning"],
        answer: "Webdev"
    },
    {
        question: "which is volatile?",
        options: ["RAM", "ROM", "Both", "none"],
        answer: "RAM"
    },
    {
        question: "Which company developed the Java programming language?",
        options: ["Microsoft", "Sun Microsystems", "Oracle", "IBM"],
        answer: "Sun Microsystems"
    },
    {
        question: "What is a binary number system?",
        options: ["Base 2", "Base 8", "Base 10", "Base 16"],
        answer: "Base 2"
    },
    {
        question: "Which protocol is used to send emails?",
        options: ["HTTP", "SMTP", "FTP", "TCP"],
        answer: "SMTP"
    }
];


// DOM Elements
const questionText = document.querySelector(".question");
const questionNumberSpan = document.querySelector(".questionno span:nth-child(2)");
const optionsContainer = document.querySelector(".options");
const nextBtn = document.querySelector(".next");
const prevBtn = document.querySelector(".prev");

let currentQuestionIndex = 0;
let score = 0;
let selectedQuestions = [];
const audio = new Audio("music.wav");

// Get selected topic from localStorage
const topic = localStorage.getItem("selectedTopic");
let time = parseInt(localStorage.getItem("time"));
const timeSpan = document.querySelector("#timer");

setInterval(() => {
    if (time < 0) {
        timeSpan.parentElement.style.display = "none";
        return;
    }

    let minutes = Math.floor(time / 60);
    let seconds = time % 60;
    if (minutes < 10) minutes = "0" + minutes;
    if (seconds < 10) seconds = "0" + seconds;
    timeSpan.textContent = minutes + ":" + seconds;
    time--;
    if (time === 0) {
        showResults();
        audio.currentTime = 2;
        audio.play();
        setTimeout(() => audio.pause(), 2000);
    }
}, 1000);


// Select the correct question
if (topic === "Pakistan History") {
    selectedQuestions = pakistanHistoryQuestions;
} else if (topic === "World History") {
    selectedQuestions = worldHistoryQuestions;
} else if (topic === "Science") {
    selectedQuestions = scienceQuestions;
} else if (topic === "Computer Science") {
    selectedQuestions = computerScienceQuestions;
} else {
    selectedQuestions = pakistanHistoryQuestions;
}

// Function to load a question
function loadQuestion() {
    // Check 
    if (!selectedQuestions || currentQuestionIndex >= selectedQuestions.length) {
        showResults();
        audio.currentTime = 2;
        audio.play();
        setTimeout(() => audio.pause(), 2000);
        return;
    }

    const currentQuestion = selectedQuestions[currentQuestionIndex];

    // Update Question Text and Number

    if (questionText) questionText.textContent = currentQuestion.question;
    if (questionNumberSpan) questionNumberSpan.textContent = currentQuestionIndex + 1;

    // Clear previous options
    if (optionsContainer) {
        optionsContainer.innerHTML = "";

        // Create new options
        currentQuestion.options.forEach(optionText => {
            const optionDiv = document.createElement("div");
            optionDiv.classList.add("option");
            optionDiv.textContent = optionText;

            // Add Click Event to Option
            optionDiv.addEventListener("click", () => checkAnswer(optionDiv, optionText));

            optionsContainer.appendChild(optionDiv);
        });
    }
}

// Function to check answer
function checkAnswer(selectedOptionDiv, selectedText) {
    const correctAnswer = selectedQuestions[currentQuestionIndex].answer;

    // Disable all options to prevent multiple clicks
    const allOptions = document.querySelectorAll(".option");
    allOptions.forEach(opt => opt.style.pointerEvents = "none");

    if (selectedText === correctAnswer) {
        selectedOptionDiv.style.backgroundColor = "green";
        selectedOptionDiv.style.color = "white";
        score++;
    } else {
        selectedOptionDiv.style.backgroundColor = "red";
        selectedOptionDiv.style.color = "white";

        // Highlight the correct answer
        allOptions.forEach(opt => {
            if (opt.textContent === correctAnswer) {
                opt.style.backgroundColor = "green";
                opt.style.color = "white";
            }
        });
    }
}

// Next Button Logic
if (nextBtn) {
    nextBtn.addEventListener("click", () => {
        if (currentQuestionIndex < selectedQuestions.length - 1) {
            currentQuestionIndex++;
            loadQuestion();
        } else {
            // End of quiz
            showResults();
            audio.currentTime = 2;
            audio.play();
            setTimeout(() => audio.pause(), 2000);
        }
    });
}

// Previous Button Logic
if (prevBtn) {
    prevBtn.addEventListener("click", () => {
        if (currentQuestionIndex > 0) {
            currentQuestionIndex--;
            loadQuestion();
        }
    });
}

// Show Results Function
function showResults() {
    if (optionsContainer) {
        optionsContainer.innerHTML = `
            <div style="text-align: center; width: 100%;">
                <h3>You scored ${score} out of ${selectedQuestions.length}!</h3>
                <div class="button" onclick="window.location.href='index.html'" style="margin: 20px auto; background-color: #eaef8a; color: black;">Home</div>
            </div>`;
    }
    if (questionText) questionText.textContent = "Quiz Completed";
    if (nextBtn) nextBtn.style.display = "none";
    if (prevBtn) prevBtn.style.display = "none";
}

// Initialize Quiz if elements exist
if (questionText && optionsContainer) {
    loadQuestion();
}
